---
title: "`r params$dynamictitle`"
author: "Alison Hill"
date: "`r params$reportdate`"
params:
  dynamictitle: Texas Housing Prices
  reportdate: !r Sys.Date()
  viridis_palette: viridis
output_format:
  html_document:
    highlighter: null
    theme: null
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
ggplot2::theme_set(ggplot2::theme_minimal())
```


# Packages and data

We'll use `ggplot2` for visualization, and some light `dplyr` for data wrangling. The `txhousing` data is loaded for you when you install and load the `ggplot2` package.

```{r}
library(ggplot2) # plotting
library(dplyr) # wrangling
txsamp <- txhousing %>% 
  filter(city %in% c("Houston", "Fort Worth", "San Antonio", "Dallas", "Austin"))
```

# Austin is expensive

```{r}
ggplot(data = txsamp, aes(x = sales, y = median)) +
   geom_point(aes(colour = city)) + 
   scale_colour_viridis_d("City\nCenter", option = params$viridis_palette)
```

# Austin prices on the rise 

```{r}
ggplot(data = filter(txsamp, city == "Austin"), aes(x = sales, y = median)) +
   geom_point(aes(colour = year)) + 
   scale_colour_viridis_c("Austin by year", option = params$viridis_palette, direction = -1) 
```

# Fort Worth has more affordable housing

```{r}
library(scales) # to make y-axis in non-scientific notation
ggplot(txsamp, aes(x = median, fill = city)) +
  geom_histogram(aes(weight = sales), position = "dodge", binwidth = 15000) +
  scale_fill_viridis_d(option = params$viridis_palette)+
  scale_y_continuous(labels = comma)
```

# The current pace of sales is fast

"Months inventory": amount of time it would take to sell all current listings at current pace of sales.

```{r}
ggplot(data = txsamp, aes(x = year, y = inventory, colour = city)) +
  geom_point() + 
  geom_smooth(se = FALSE) +
  scale_colour_viridis_d("City\nCenter", option = params$viridis_palette) 
```

# Thanks to...

+ Jennifer Thompson: https://github.com/jenniferthompson/ParamRmdExample
+ Garrett Grolemund: https://rmarkdown.rstudio.com/lesson-6.html
